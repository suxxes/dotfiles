# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'catppuccin/tmux'

set -g @suxxes-session-uuid-pattern "^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$"
set -g @suxxes-session-is-uuid '#{m|ri:#{q|l:@suxxes-session-uuid-pattern},#{session_name}}'
set -g @suxxes-session-text "#{?#{E:@suxxes-session-is-uuid},#{=4:session_name}...#{=-4:session_name},#{session_name}}"

set -g @catppuccin_application_text " #{pane_current_command}"
set -g @catppuccin_session_text " #{E:@suxxes-session-text}"
set -g @catppuccin_directory_text " #T"
set -g @catppuccin_date_time_text " %I:%M%p"

set -g @catppuccin_application_color "#{E:@thm_green}"
set -g @catppuccin_session_color "#{E:@thm_maroon}"

set -g @catppuccin_application_icon "󰘳"
set -g @catppuccin_cpu_icon ""
set -g @catppuccin_date_time_icon "󱑌"
set -g @catppuccin_gitmux_icon "󰊢"
set -g @catppuccin_session_icon ""
set -g @catppuccin_directory_icon ""
set -g @catppuccin_host_icon "󱟄"
set -g @catppuccin_uptime_icon "󱎫"
set -g @batt_icon_status_charged ""
set -g @catppuccin_battery_icon "#{l:#{battery_icon}}"

set -g @catppuccin_window_status_style "custom"

set -g @catppuccin_window_left_separator " "
set -g @catppuccin_window_middle_separator " "
set -g @catppuccin_window_right_separator " "
set -g @catppuccin_window_current_number "#{E:@suxxes-session-text}"

########################################################################################################################

set -g @suxxes-status-separator "#[fg=#{E:@catppuccin_status_module_text_bg},bg=default]█ "

set -g @catppuccin_status_background "#{E:@catppuccin_window_current_text_color}"
set -g @catppuccin_status_left_separator "#[bg=#{E:@catppuccin_status_module_text_bg}]█"
set -g @catppuccin_status_middle_separator "#[bg=#{E:@catppuccin_status_module_text_bg},fg=#{E:@catppuccin_status_module_text_fg}] "
set -g @catppuccin_status_right_separator "█"
set -g @catppuccin_status_left_separator_inverse "no"
set -g @catppuccin_status_middle_separator_inverse "no"
set -g @catppuccin_status_right_separator_inverse "no"
set -g @catppuccin_status_connect_separator "yes"

########################################################################################################################

source -F "~/.tmux/custom/ram.conf"

run '~/.tmux/plugins/tmux-cpu/cpu.tmux'
run '~/.tmux/plugins/tmux-battery/battery.tmux'
run '~/.tmux/plugins/tmux/catppuccin.tmux'

set -g prefix C-a
unbind C-b

bind C-a send-prefix
bind R source-file ~/.tmux.conf

set -g mouse on
set -g default-shell $SHELL
set -g default-terminal "xterm-256color"
set -ag terminal-overrides ",xterm-256color:Tc"

set-option -g status-position bottom
set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
set-option -g default-command 'tput clear; tput cup (tput lines) 0; exec $SHELL'

set-window-option -g allow-rename off

# Index windows from 1
set-option -g base-index 1

# Automatically renumber the windows to follow this rule
set-option -g renumber-windows on

# Switch between windows from 1 to 0 (10)
bind -n M-1 if-shell 'tmux select-window -t  1' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-2 if-shell 'tmux select-window -t  2' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-3 if-shell 'tmux select-window -t  3' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-4 if-shell 'tmux select-window -t  4' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-5 if-shell 'tmux select-window -t  5' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-6 if-shell 'tmux select-window -t  6' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-7 if-shell 'tmux select-window -t  7' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-8 if-shell 'tmux select-window -t  8' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-9 if-shell 'tmux select-window -t  9' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'
bind -n M-0 if-shell 'tmux select-window -t 10' '' 'run-shell "tmux new-window -t $(($(tmux lsw | wc -l) + 1))"'

# Close window with confirmation unless in shell
bind -n M-w if-shell "[ #{pane_current_command} = $(basename $SHELL) ]" 'kill-window' 'confirm-before -p "Kill window running #{pane_current_command}? (y/n)" kill-window'

set -s escape-time 0
set -g status-interval 5

set -g status-left-length 25
set -g status-right-length 100

set -g status-left ""
set -g status-right ""

set -agF status-right "#{E:@catppuccin_status_cpu}"
set -agF status-right "#{E:@catppuccin_status_ram}"
set -agF status-right "#{E:@catppuccin_status_battery}"
set -agF status-right "#{E:@catppuccin_status_date_time}"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
